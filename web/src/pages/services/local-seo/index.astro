---
// src/pages/services/local-seo.astro
import Layout from "../../../layouts/Layout.astro";

const siteUrl = "https://brandsbuilders.agency";

const seo = {
  title: "Local SEO & Google Business Profile | Growth Partner Capability",
  description:
    "Local SEO delivered only within our Growth Partner model. We integrate web, GBP, reviews, on-page and measurement to turn nearby searches into revenue. Entry via Free 72-Hour Growth Sprint.",
  canonical: `${siteUrl}/services/local-seo`,
  ogImage: `${siteUrl}/images/og/local-seo-og.jpg`,
};

// Capability bullets (not packages, not purchasable)
const capability = [
  "On-page local optimization for key service & location pages (titles, metas, H1–H3, internal links, contact blocks).",
  "LocalBusiness / FAQ schema where relevant; breadcrumb & Article schema on content.",
  "Google Business Profile hygiene & optimization: categories, services, attributes, hours, UTM tracking.",
  "Reviews engine: short asks, QR/link cards, response templates, team cadence.",
  "Search Console targets, GA4 goals and events for calls, forms and bookings.",
  "Core Web Vitals sanity and quick wins to protect local conversion on mobile."
];

// Example 90-day operating plan (illustrative, not a package)
const plan90 = [
  { phase: "Weeks 1–2", items: ["Technical & local audit (site + GBP)", "Keyword/intent map (services & locations)", "Fix crawl/index/canonical basics", "Define review + post cadence"] },
  { phase: "Weeks 3–6", items: ["Ship on-page updates for top services/locations", "Publish 2–3 FAQs per page with schema", "GBP pass: photos, categories, services, posts", "Implement call/form tracking and dashboards"] },
  { phase: "Weeks 7–12", items: ["Expand to secondary locations/services", "Light A/B on headline/CTA where volume allows", "Review growth levers & blockers, adjust cadence", "Prep next 90-day roadmap"] }
];

// What good fit looks like (aligns with your ICP)
const goodFit = [
  "Owner-led SMB with 2–10 employees and capacity to take more demand in 30–90 days.",
  "Service lines with ≥ $150–$400 value per appointment, or e-commerce with healthy AOV (≥ $60).",
  "Based in Alberta (Calgary, Edmonton, Airdrie, Lethbridge, Red Deer).",
  "Visible digital gap (DIY site, weak GBP/reviews, slow pages) and willingness to fix it fast."
];
---

<Layout seo={seo}>
  <!-- HERO -->
  <section class="relative overflow-hidden bg-gradient-to-b from-slate-950 to-slate-900">
    <div class="pointer-events-none absolute inset-0" aria-hidden="true" role="presentation">
      <div class="absolute -top-24 -left-24 h-[30rem] w-[30rem] rounded-full bg-violet-600/20 blur-3xl"></div>
      <div class="absolute -bottom-24 -right-24 h-[30rem] w-[30rem] rounded-full bg-fuchsia-600/15 blur-3xl"></div>
    </div>

    <div class="container mx-auto px-6 relative z-10 py-16 md:py-20">
      <div class="max-w-4xl">
        <p class="inline-flex items-center gap-2 rounded-full border border-violet-500/30 bg-violet-500/10 px-3 py-1.5 text-violet-200 text-xs mb-4">
          <span class="inline-block h-1.5 w-1.5 rounded-full bg-violet-400"></span>
          Capability within Growth Partner — not sold standalone
        </p>
        <h1 class="text-4xl md:text-5xl font-black leading-tight text-white mb-4">
          Local SEO &amp; Google Business Profile
          <span class="block bg-gradient-to-r from-violet-300 via-fuchsia-300 to-indigo-300 bg-clip-text text-transparent">
            turn nearby searches into booked revenue
          </span>
        </h1>
        <p class="text-slate-300 text-base md:text-lg max-w-2xl">
          We operate Local SEO only as part of our <strong>Growth Partner</strong> engagement. Web, GBP,
          reviews, content, and measurement ship together under one plan. Entry: the <strong>Free 72-Hour Growth Sprint</strong>.
        </p>

        <div class="flex flex-wrap gap-3 mt-6">
          <a href="#capabilities" class="inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-violet-600 to-fuchsia-600 px-5 py-3 font-semibold text-white">
            See how we improve local visibility
          </a>
          <a href="#free-sprint" class="inline-flex items-center gap-2 rounded-xl border border-slate-700 px-5 py-3 text-slate-200 hover:border-violet-500 hover:bg-violet-500/10 transition">
            Apply for Free 72-Hour Sprint
          </a>
        </div>
        <p class="mt-4 text-xs text-slate-500">Alberta • Open 9am–9pm daily</p>
      </div>
    </div>
  </section>

  <!-- CAPABILITIES (NOT packages) -->
  <section id="capabilities" class="py-16 bg-slate-950">
    <div class="container mx-auto px-6">
      <header class="mb-8">
        <h2 class="text-3xl lg:text-4xl font-bold text-white">What we actually do</h2>
        <p class="text-slate-400">Integrated Local SEO work streams delivered inside a single Growth Partner engagement.</p>
      </header>

      <div class="grid md:grid-cols-2 gap-6">
        <article class="rounded-2xl border border-slate-800 bg-slate-900/60 p-6">
          <h3 class="text-white font-semibold mb-3">Core capabilities</h3>
          <ul class="space-y-2 text-slate-300 text-sm">
            {capability.map((c) => (
              <li class="flex gap-2">
                <svg class="w-4 h-4 text-violet-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>
                {c}
              </li>
            ))}
          </ul>
        </article>

        <article class="rounded-2xl border border-slate-800 bg-slate-900/60 p-6">
          <h3 class="text-white font-semibold mb-3">Signals we measure</h3>
          <ul class="space-y-2 text-slate-300 text-sm">
            <li class="flex gap-2">
              <svg class="w-4 h-4 text-violet-400" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              GBP actions (calls, direction requests, website visits)
            </li>
            <li class="flex gap-2">
              <svg class="w-4 h-4 text-violet-400" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              Local impressions and discovery vs. branded queries
            </li>
            <li class="flex gap-2">
              <svg class="w-4 h-4 text-violet-400" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              Conversion rate from service/location pages (forms, calls, bookings)
            </li>
            <li class="flex gap-2">
              <svg class="w-4 h-4 text-violet-400" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              Review velocity and rating trend
            </li>
          </ul>
        </article>
      </div>
    </div>
  </section>

  <!-- 90-DAY PLAN (Illustrative, not selectable) -->
  <section class="py-16 bg-slate-900">
    <div class="container mx-auto px-6">
      <header class="mb-8">
        <h2 class="text-3xl lg:text-4xl font-bold text-white">Illustrative 90-day plan</h2>
      </header>

      <div class="grid md:grid-cols-3 gap-6">
        {plan90.map((p) => (
          <article class="rounded-2xl border border-slate-800 bg-slate-900/60 p-6">
            <h3 class="text-white font-semibold mb-3">{p.phase}</h3>
            <ul class="space-y-2 text-slate-300 text-sm">
              {p.items.map((i) => (
                <li class="flex gap-2">
                  <svg class="w-4 h-4 text-violet-400" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                  {i}
                </li>
              ))}
            </ul>
          </article>
        ))}
      </div>

      <div class="mt-8">
        <a href="#free-sprint" class="inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-violet-600 to-fuchsia-600 px-5 py-3 font-semibold text-white">
          Apply for Free 72-Hour Sprint
        </a>
      </div>
    </div>
  </section>

  <!-- FIT (aligns with ICP) -->
  <section class="py-16 bg-slate-950">
    <div class="container mx-auto px-6">
      <header class="mb-8">
        <h2 class="text-3xl lg:text-4xl font-bold text-white">Who this is for</h2>
        <p class="text-slate-400">We work with a small number of owner-led brands where Local SEO moves revenue quickly.</p>
      </header>

      <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-6">
        <ul class="grid md:grid-cols-2 gap-3 text-slate-300 text-sm">
          {goodFit.map((g) => (
            <li class="flex gap-2">
              <svg class="w-4 h-4 text-violet-400" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              {g}
            </li>
          ))}
        </ul>
      </div>
    </div>
  </section>

  <!-- GUARANTEES -->
  <section class="py-16 bg-slate-900">
    <div class="container mx-auto px-6">
      <h2 class="text-2xl md:text-3xl font-bold text-white mb-6">What we guarantee</h2>
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4">
        <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5">
          <h3 class="text-white font-semibold mb-1">Performance</h3>
          <p class="text-slate-300 text-sm">Mobile Lighthouse ≥ 90 and LCP &lt; 2.5s on new pages (trade-offs documented).</p>
        </div>
        <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5">
          <h3 class="text-white font-semibold mb-1">Accessibility</h3>
          <p class="text-slate-300 text-sm">WCAG 2.1 A/AA essentials on shipped templates.</p>
        </div>
        <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5">
          <h3 class="text-white font-semibold mb-1">Ownership</h3>
          <p class="text-slate-300 text-sm">You own domain, code and content from day one.</p>
        </div>
        <div class="rounded-2xl border border-slate-800 bg-slate-900/60 p-5">
          <h3 class="text-white font-semibold mb-1">Warranty</h3>
          <p class="text-slate-300 text-sm">30-day bug fixes; 60-day coverage for critical lead-flow blockers.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- FREE SPRINT APPLICATION (Netlify) -->
  <section id="free-sprint" class="py-16 bg-gradient-to-b from-gray-950 to-gray-900">
    <div class="container mx-auto px-6">
      <div class="text-center mb-12">
        <h2 class="text-3xl lg:text-5xl font-bold mb-6 text-white">
          Apply for your <span class="bg-gradient-to-r from-violet-400 to-fuchsia-400 bg-clip-text text-transparent">Free 72-Hour Growth Sprint</span>
        </h2>
        <p class="text-gray-400 text-lg max-w-2xl mx-auto">
          We’ll review your website & Google presence, then send a 2-minute Loom with quick wins — within 72 hours.
          <span class="text-slate-300"> Limited Alberta slots weekly. No credit card.</span>
        </p>
      </div>

      <div class="max-w-2xl mx-auto">
        <form
          name="sprint-apply-local"
          method="POST"
          action="/sprint/thanks"
          data-netlify="true"
          netlify-honeypot="bot-field"
          class="bg-gray-900/50 border border-gray-800 backdrop-blur-sm rounded-3xl p-8"
          novalidate
        >
          <input type="hidden" name="form-name" value="sprint-apply-local" />
          <p class="hidden"><label>Don’t fill this out if you’re human: <input name="bot-field" /></label></p>
          <input type="text" name="trap_url" tabindex="-1" autocomplete="off" class="hidden" aria-hidden="true" />

          <!-- Business + Website -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
              <label for="business_name" class="block text-sm font-medium text-gray-300 mb-2">Business name *</label>
              <input id="business_name" name="business_name" required class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white placeholder-gray-400 focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-colors" placeholder="Your company name" />
              <div class="text-red-400 text-sm mt-1" data-error-for="business_name" aria-live="polite"></div>
            </div>

            <div>
              <label for="site_url" class="block text-sm font-medium text-gray-300 mb-2">Website URL *</label>
              <input id="site_url" name="site_url" type="url" required pattern="^https?:\\/\\/.*" class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white placeholder-gray-400 focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-colors" placeholder="https://yourwebsite.com" />
              <div class="text-red-400 text-sm mt-1" data-error-for="site_url" aria-live="polite"></div>
            </div>
          </div>

          <!-- City -->
          <div class="mb-6">
            <label for="city" class="block text-sm font-medium text-gray-300 mb-2">City (Alberta) *</label>
            <select id="city" name="city" required class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-colors">
              <option value="">Select your city</option>
              <option value="Calgary">Calgary</option>
              <option value="Edmonton">Edmonton</option>
              <option value="Airdrie">Airdrie</option>
              <option value="Lethbridge">Lethbridge</option>
              <option value="Red Deer">Red Deer</option>
              <option value="Other (Alberta)">Other (Alberta)</option>
            </select>
            <div class="text-red-400 text-sm mt-1" data-error-for="city" aria-live="polite"></div>
          </div>

          <!-- GBP + Platform -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
              <span class="block text-sm font-medium text-gray-300 mb-2">Google Business Profile *</span>
              <div class="flex items-center gap-6 text-gray-300">
                <label class="inline-flex items-center gap-2">
                  <input type="radio" name="has_gbp" value="Yes" required class="text-violet-600 focus:ring-violet-500" />
                  <span>Yes</span>
                </label>
                <label class="inline-flex items-center gap-2">
                  <input type="radio" name="has_gbp" value="No" required class="text-violet-600 focus:ring-violet-500" />
                  <span>No</span>
                </label>
              </div>
              <div class="text-red-400 text-sm mt-1" data-error-for="has_gbp" aria-live="polite"></div>
            </div>

            <div>
              <label for="platform" class="block text-sm font-medium text-gray-300 mb-2">Website platform *</label>
              <select id="platform" name="platform" required class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-colors">
                <option value="">Select platform</option>
                <option value="Wix">Wix</option>
                <option value="Squarespace">Squarespace</option>
                <option value="Shopify">Shopify</option>
                <option value="WordPress">WordPress</option>
                <option value="Custom Code">Custom Code</option>
                <option value="Not sure">Not sure</option>
              </select>
              <div class="text-red-400 text-sm mt-1" data-error-for="platform" aria-live="polite"></div>
            </div>
          </div>

          <!-- Contact preference -->
          <div class="mb-6">
            <span class="block text-sm font-medium text-gray-300 mb-2">Preferred contact *</span>
            <div class="flex flex-wrap items-center gap-6 text-gray-300">
              <label class="inline-flex items-center gap-2"><input type="radio" name="contact_pref" value="Email" required class="text-violet-600 focus:ring-violet-500" /><span>Email</span></label>
              <label class="inline-flex items-center gap-2"><input type="radio" name="contact_pref" value="Text" required class="text-violet-600 focus:ring-violet-500" /><span>Text</span></label>
              <label class="inline-flex items-center gap-2"><input type="radio" name="contact_pref" value="Call" required class="text-violet-600 focus:ring-violet-500" /><span>Call</span></label>
            </div>
            <div class="text-red-400 text-sm mt-1" data-error-for="contact_pref" aria-live="polite"></div>
          </div>

          <!-- Email + Phone -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
            <div>
              <label for="email2" class="block text-sm font-medium text-gray-300 mb-2">Email *</label>
              <input id="email2" name="email" type="email" required pattern="^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$" class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white placeholder-gray-400 focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-colors" placeholder="you@company.com" />
              <div class="text-red-400 text-sm mt-1" data-error-for="email" aria-live="polite"></div>
            </div>
            <div>
              <label for="phone" class="block text-sm font-medium text-gray-300 mb-2">Phone (optional)</label>
              <input id="phone" name="phone" type="tel" class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white placeholder-gray-400 focus:border-violet-500 focus:ring-1 focus:ring-violet-500 transition-colors" placeholder="+1 403 555 0123" />
            </div>
          </div>

          <!-- Consent (Loom + contact) -->
          <div class="mb-6">
            <label class="flex items-start gap-3">
              <input type="checkbox" id="consent_looom" name="consent_looom" required class="mt-1 w-4 h-4 text-violet-600 border-gray-600 rounded focus:ring-violet-500 focus:ring-2 bg-gray-800" />
              <span class="text-sm text-gray-400 leading-relaxed">
                I agree to receive a <strong>free 2-minute Loom</strong> using public information from my website and Google Business Profile. No account access is requested at this stage.
              </span>
            </label>
            <div class="text-red-400 text-sm mt-1" data-error-for="consent_looom" aria-live="polite"></div>
          </div>

          <div class="mb-8">
            <label class="flex items-start gap-3">
              <input type="checkbox" id="consent_contact" name="consent_contact" required class="mt-1 w-4 h-4 text-violet-600 border-gray-600 rounded focus:ring-violet-500 focus:ring-2 bg-gray-800" />
              <span class="text-sm text-gray-400 leading-relaxed">
                I agree to be contacted about my Sprint results (email, text or call). PIPEDA-aware: minimal data; opt-out anytime.
              </span>
            </label>
            <div class="text-red-400 text-sm mt-1" data-error-for="consent_contact" aria-live="polite"></div>
          </div>

          <button type="submit" class="w-full bg-gradient-to-r from-violet-600 to-fuchsia-600 text-white font-bold py-4 px-8 rounded-xl hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-violet-500/25 disabled:opacity-50 disabled:cursor-not-allowed">
            Start My Free 72-Hour Sprint
          </button>

          <p class="text-xs text-slate-500 mt-3">Typical turnaround: 2–3 business days • Alberta businesses only</p>
        </form>
      </div>
    </div>
  </section>

  <!-- JSON-LD -->
  <script type="application/ld+json">
    {JSON.stringify({
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "WebPage",
          url: `${siteUrl}/services/local-seo`,
          name: "Local SEO & Google Business Profile | BrandsBuilders Agency",
          description: seo.description,
          inLanguage: "en-CA",
          breadcrumb: {
            "@type": "BreadcrumbList",
            itemListElement: [
              { "@type": "ListItem", position: 1, name: "Home", item: siteUrl },
              { "@type": "ListItem", position: 2, name: "Services", item: `${siteUrl}/services` },
              { "@type": "ListItem", position: 3, name: "Local SEO", item: `${siteUrl}/services/local-seo` }
            ]
          },
          isPartOf: { "@type": "WebSite", url: siteUrl }
        },
        {
          "@type": "Service",
          name: "Local SEO & GBP (within Growth Partner)",
          serviceType: "Local search optimization",
          areaServed: [
            { "@type": "AdministrativeArea", name: "Alberta" },
            { "@type": "City", name: "Calgary" },
            { "@type": "City", name: "Edmonton" }
          ],
          offers: {
            "@type": "Offer",
            availability: "https://schema.org/InStock",
            url: `${siteUrl}/services/local-seo`
          },
          provider: { "@type": "Organization", name: "BrandsBuilders Agency", url: siteUrl },
          description: "Delivered only as part of our Growth Partner engagement. No à la carte packages."
        },
        {
          "@type": "WebApplication",
          name: "Free 72-Hour Growth Sprint — Application",
          url: `${siteUrl}/services/local-seo#free-sprint`,
          description: "Free audit sprint for Alberta owner-led SMBs. 2-minute Loom with opportunities delivered within 72 hours.",
          applicationCategory: "BusinessApplication"
        },
        {
          "@type": "FAQPage",
          mainEntity: [
            { "@type": "Question", name: "Is this a standalone service?", acceptedAnswer: { "@type": "Answer", text: "No. Local SEO is delivered inside our Growth Partner model so web, GBP, reviews and analytics move together." } },
            { "@type": "Question", name: "Do you guarantee rankings?", acceptedAnswer: { "@type": "Answer", text: "No one can. We focus on durable inputs (on-page, GBP, reviews, CWV) that improve qualified traffic and conversions." } },
            { "@type": "Question", name: "How fast will I see results?", acceptedAnswer: { "@type": "Answer", text: "Many SMBs see movement in 30–90 days when we can ship changes and collect reviews consistently." } },
            { "@type": "Question", name: "Do you handle posts/photos?", acceptedAnswer: { "@type": "Answer", text: "We create the cadence and templates and can operate posts with you under the engagement." } }
          ]
        }
      ]
    })}
  </script>

  <!-- Minimal inline validation -->
  <script is:inline>
    (function () {
      var form = document.querySelector('form[name="sprint-apply-local"]');
      if (!form) return;

      function err(el, msg) {
        var slot = form.querySelector('[data-error-for="' + (el.name || '') + '"]');
        if (slot) slot.textContent = msg || '';
      }

      var validators = {
        business_name: function (el) { return el.value.trim() ? '' : 'Please enter your business name.'; },
        site_url: function (el) {
          if (!el.value.trim()) return 'Please enter your website URL.';
          var ok = /^https?:\\/\\//i.test(el.value.trim());
          return ok ? '' : 'URL must start with http:// or https://';
        },
        city: function (el) { return el.value ? '' : 'Please select your city.'; },
        has_gbp: function () {
          var checked = form.querySelector('input[name="has_gbp"]:checked');
          return checked ? '' : 'Please select an option.';
        },
        platform: function (el) { return el.value ? '' : 'Please select your platform.'; },
        contact_pref: function () {
          var checked = form.querySelector('input[name="contact_pref"]:checked');
          return checked ? '' : 'Please select a contact method.';
        },
        email: function (el) {
          if (!el.value.trim()) return 'Please enter your email.';
          var ok = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(el.value);
          return ok ? '' : 'Enter a valid email address.';
        },
        consent_looom: function (el) { return el.checked ? '' : 'Consent to receive the Loom is required.'; },
        consent_contact: function (el) { return el.checked ? '' : 'Contact permission is required.'; }
      };

      // radios validated as groups by name
      var fields = Array.prototype.slice.call(form.elements).filter(function (el) {
        return ['business_name','site_url','city','platform','email','consent_looom','consent_contact'].includes(el.name)
               || el.name === 'has_gbp' || el.name === 'contact_pref';
      });

      fields.forEach(function (el) {
        var ev = (el.type === 'radio' || el.tagName === 'SELECT' || el.type === 'checkbox') ? 'change' : 'input';
        el.addEventListener(ev, function () {
          var name = el.name;
          var msg = '';
          if (name === 'has_gbp' || name === 'contact_pref') {
            msg = validators[name]();
          } else if (validators[name]) {
            msg = validators[name](el);
          }
          if (name === 'has_gbp') {
            var any = form.querySelector('input[name="has_gbp"]');
            if (any) err(any, msg);
          } else if (name === 'contact_pref') {
            var any2 = form.querySelector('input[name="contact_pref"]');
            if (any2) err(any2, msg);
          } else {
            err(el, msg);
          }
        });
      });

      form.addEventListener('submit', function (e) {
        var hasErrors = false;
        ['has_gbp','contact_pref'].forEach(function (group) {
          var msg = validators[group]();
          var any = form.querySelector('input[name="' + group + '"]');
          if (any) err(any, msg);
          if (msg) hasErrors = true;
        });
        fields.forEach(function (el) {
          if (el.type === 'radio') return;
          var msg = validators[el.name] ? validators[el.name](el) : '';
          err(el, msg);
          if (msg) hasErrors = true;
        });
        if (hasErrors) e.preventDefault();
      });
    })();
  </script>
</Layout>
