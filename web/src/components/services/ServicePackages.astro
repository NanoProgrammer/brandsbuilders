---
type Pkg = {
  tier: 'small' | 'mid';
  name: string;
  tagline: string;
  price: string;
  delivery: string;
  features: string[];
  highlight?: boolean;
};

const DEFAULT_TIER: 'small' | 'mid' = 'small';

const packages: Pkg[] = [
  // Small Business (30–45 days)
  {
    tier: 'small',
    name: 'Go-to-Market Launch',
    tagline: 'Brand + Landing (no local on-page)',
    price: '$2,000–$3,200 CAD',
    delivery: '30–45 days',
    features: [
      'Brand Launch (light)',
      'CRO-first landing (5–7 sections)',
      'Technical SEO baseline',
      'Analytics/events setup',
      'GBP setup & optimization',
    ],
  },
  {
    tier: 'small',
    name: 'Local Service Site',
    tagline: 'Identity + 3–7 pages + local on-page',
    price: '$3,000–$4,500 CAD',
    delivery: '30–45 days',
    features: [
      'Home, Services, About, Contact',
      'Local on-page structure & schema',
      'GBP setup & review prompts',
      'Media lite social kit',
      'Analytics/events configured',
    ],
    highlight: true,
  },
  {
    tier: 'small',
    name: 'Starter Shop (≤20 products)',
    tagline: 'Identity + e-commerce base + technical SEO',
    price: '$7,500–$10,000 CAD',
    delivery: '6–8 weeks',
    features: [
      'PLP/PDP + checkout + emails',
      'Product schema & canonicals',
      'Social commerce kit',
      'Analytics/events configured',
      'Owner training & handoff',
    ],
  },

  // Mid-Market (6–10 weeks)
  {
    tier: 'mid',
    name: 'Rebrand & Site Foundation',
    tagline: 'Full rebrand + scalable site + CMS',
    price: '$7,500–$12,500 CAD',
    delivery: '6–10 weeks',
    features: [
      'Identity system & guidelines',
      'Component library + CMS',
      'Performance mobile 90+ target',
      'Technical + on-page base',
      'AA essentials on templates',
    ],
    highlight: true,
  },
  {
    tier: 'mid',
    name: 'Content System & On-Page Lift',
    tagline: 'CMS models + 10–20 URLs optimized',
    price: '$2,500–$5,000 CAD',
    delivery: '4–6 weeks',
    features: [
      'Blog/Case/Category models',
      'Titles/metas/H1–H3/internal links',
      'Article/FAQ/Breadcrumb schema',
      'GSC mapping & GA4 goals',
      '90-day editorial playbook',
    ],
  },
  {
    tier: 'mid',
    name: 'E-commerce Foundation',
    tagline: 'Catalog modeling + PLP/PDP pro + checkout',
    price: '$13,000–$20,000 CAD',
    delivery: '6–10 weeks',
    features: [
      'Facets & merchandising rules',
      'Advanced PLP/PDP (variants, trust)',
      'Checkout + transactional emails',
      'Product/Breadcrumb schema',
      'Analytics/events configured',
    ],
  },
];
---

<section id="packages" class="py-20 lg:py-24 bg-slate-950">
  <div class="container mx-auto px-6">
    <div class="text-center mb-10">
      <h2 class="text-3xl lg:text-4xl font-bold text-white">Packages</h2>
      <p class="text-slate-400 mt-2">Transparent ranges; final quote depends on scope and assets.</p>
    </div>

    <!-- Tabs -->
    <div class="flex justify-center mb-8 gap-2" id="pkg-tabs">
      <button
        class="px-4 py-2 rounded-full border border-slate-700 text-slate-200 data-[active=true]:bg-violet-600 data-[active=true]:border-violet-600 data-[active=true]:text-white"
        data-tier="small"
        data-active="true"
        aria-pressed="true"
      >
        Small Business
      </button>
      <button
        class="px-4 py-2 rounded-full border border-slate-700 text-slate-200 data-[active=true]:bg-violet-600 data-[active=true]:border-violet-600 data-[active=true]:text-white"
        data-tier="mid"
        aria-pressed="false"
      >
        Mid-Market
      </button>
    </div>

    <!-- Grid -->
    <div class="grid lg:grid-cols-3 gap-6" id="pkg-grid">
      {packages.map((p, i) => (
        <div
          class="pkg-card rounded-2xl border border-slate-800 bg-white/5 p-6 hover:border-violet-500/40 transition"
          data-tier={p.tier}
          style={`animation: fade-in .6s both; animation-delay:${i*80}ms;${p.tier !== DEFAULT_TIER ? 'display:none' : ''}`}
        >
          {p.highlight && (
            <div class="mb-4 inline-flex items-center rounded-full bg-gradient-to-r from-violet-600 to-fuchsia-600 px-3 py-1 text-xs font-semibold text-white">
              Recommended
            </div>
          )}
          <h3 class="text-white text-xl font-semibold">{p.name}</h3>
          <p class="text-slate-300">{p.tagline}</p>
          <div class="mt-4 text-2xl font-bold bg-gradient-to-r from-violet-300 to-fuchsia-300 bg-clip-text text-transparent">
            {p.price}
          </div>
          <div class="text-slate-400 text-sm">Typical delivery: {p.delivery}</div>

          <ul class="mt-5 space-y-2">
            {p.features.map((f) => (
              <li class="text-slate-300 text-sm inline-flex items-start gap-2">
                <svg class="w-4 h-4 mt-0.5 text-violet-300" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                </svg>
                <span>{f}</span>
              </li>
            ))}
          </ul>

          <a href="/contact" class="mt-6 inline-flex items-center justify-center w-full rounded-xl border border-slate-700 px-4 py-2 text-slate-200 hover:border-violet-500 hover:bg-violet-500/10 transition">
            Request proposal
          </a>
        </div>
      ))}
    </div>
  </div>

  <style>
    @keyframes fade-in { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none} }
  </style>

  <!-- Client-side tab logic -->
  <script is:inline>
    (() => {
      const tabWrap = document.getElementById('pkg-tabs');
      const cards = Array.from(document.querySelectorAll('.pkg-card'));
      if (!tabWrap || !cards.length) return;

      const setTier = (tier) => {
        cards.forEach((c) => {
          c.style.display = c.dataset.tier === tier ? '' : 'none';
        });
        tabWrap.querySelectorAll('button').forEach((b) => {
          const active = b.getAttribute('data-tier') === tier;
          b.setAttribute('data-active', String(active));
          b.setAttribute('aria-pressed', active ? 'true' : 'false');
        });
      };

      // initial state from markup (or fallback)
      const initial = tabWrap.querySelector('[data-active="true"]')?.getAttribute('data-tier') || 'small';
      setTier(initial);

      tabWrap.addEventListener('click', (e) => {
        const btn = e.target.closest('button');
        if (!btn) return;
        setTier(btn.getAttribute('data-tier') || 'small');
      });
    })();
  </script>
</section>
